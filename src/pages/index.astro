---
import Countdown from "@/layouts/Home/Countdown.astro";
import Live from "@/layouts/Home/Live.astro";
import Break from "@/layouts/Home/Break.astro";
import Recruitment from "@/layouts/Home/Recruitment.astro";

const RECRUITMENT_START = new Date(2024, 7, 15);
const RECRUITMENT_END = new Date(2024, 8, 15);
const SHOW_START = new Date(2025, 2, 10);
const SHOW_END = new Date(2025, 2, 17);

type Period = "recruitment" | "showStarting" | "showCurrent" | "break";

const periods: { period: Period; from: Date }[] = [
  { from: RECRUITMENT_START, period: "recruitment" },
  { from: RECRUITMENT_END, period: "showStarting" },
  { from: SHOW_START, period: "showCurrent" },
  { from: SHOW_END, period: "break" },
];

function getCurrentPeriod(): Period {
  let now = new Date();

  for (let period of periods.slice().reverse()) {
    if (period.from <= now) {
      return period.period;
    }
  }

  return "break";
}

const period = getCurrentPeriod();
---

{
  period == "break" ? (
    <Break />
  ) : period == "recruitment" ? (
    <Recruitment />
  ) : period == "showCurrent" ? (
    <Live />
  ) : (
    <Countdown to={SHOW_START} />
  )
}
